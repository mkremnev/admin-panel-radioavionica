<?phpdeclare(strict_types=1);namespace App\Military\Command\AddUnit;use App\Flusher;use App\Military\Entity\Units\Address;use App\Military\Entity\Units\Name;use App\Military\Entity\Units\Commander;use App\Military\Entity\Units\Id;use App\Military\Entity\Units\Official;use App\Military\Entity\Units\Unit;use App\Military\Entity\Units\UnitRepository;use DomainException;class Handler{    private UnitRepository $units;    private Flusher $flusher;    public function __construct(UnitRepository $units, Flusher $flusher)    {        $this->units = $units;        $this->flusher = $flusher;    }    public function handle(Command $command): void    {        $name = new Name($command->name);        if ($this->units->hasByName($name)) {            throw new DomainException("Unit already exist.");        }        $address = new Address($command->address);        $commander = new Commander(            $command->lastname,            $command->firstname,            $command->surname        );        $unit = new Unit(            Id::generate(),            $name,            $address,            $commander,            $command->amount        );        if ($command->officials){            foreach ($command->officials as $official){                $attachOfficial = new Official($official['subunit'], $official['rank'], $official['fio'], $official['telephone']);                $unit->attachOfficials($attachOfficial);            }        }        $this->units->add($unit);        $this->flusher->flush();    }}